@tailwind base;
@tailwind components;
/* --- Footer sprite cats (simple 64x64 sprites) --- */

.footer-sprite-cats {
  position: relative;
  height: 96px;
  overflow: hidden;
  border-top: 1px solid hsla(var(--border), 0.4);
  background: hsla(var(--background), 0.3);
  pointer-events: none;
}

.footer-sprite-cats__ground {
  position: absolute;
  inset-inline: 0;
  bottom: 8px;
  height: 1px;
  background: linear-gradient(
    90deg,
    transparent,
    hsla(var(--border), 0.8),
    transparent
  );
  opacity: 0.6;
}

.footer-sprite-cats__cat {
  position: absolute;
  bottom: 10px;
  left: 0;
  will-change: transform;
}

@keyframes footer-sprite-cats-pan-l2r {
  from {
    transform: translateX(-10vw);
  }
  to {
    transform: translateX(110vw);
  }
}

@keyframes footer-sprite-cats-pan-r2l {
  from {
    transform: translateX(110vw);
  }
  to {
    transform: translateX(-10vw);
  }
}

.footer-sprite-cats__cat--l2r {
  animation: footer-sprite-cats-pan-l2r 14s linear infinite;
}

.footer-sprite-cats__cat--r2l {
  animation: footer-sprite-cats-pan-r2l 16s linear infinite;
  animation-delay: -8s;
}

.footer-sprite-cats__sprite {
  /* Sheet: 14 columns x 72 rows of 64x64 tiles */
  --frame: 64px;
  --scale: 1;
  --sheet-cols: 14;
  --sheet-rows: 72;

  /* Default animation frame-count (many rows only use the first 6 frames). */
  --anim-frames: 6;
  --anim-ms: 900ms;

  /* Direction column for single-frame rows (sit/stand): down/up/right/left */
  --dir-col: 0;

  /* Row index (0-based) */
  --row: 0;

  display: block;
  width: calc(var(--frame) * var(--scale));
  height: calc(var(--frame) * var(--scale));
  background-image: var(--sprite-url);
  background-repeat: no-repeat;
  background-size: calc(var(--sheet-cols) * var(--frame) * var(--scale))
    calc(var(--sheet-rows) * var(--frame) * var(--scale));
  background-position-x: 0px;
  background-position-y: calc(var(--row) * var(--frame) * var(--scale) * -1);
  image-rendering: pixelated;
}

/* Sprite URL mapping */
.footer-sprite-cats__sprite[data-cat="1"] {
  --sprite-url: url("/images/cats/cat 1 (64х64).png");
}

.footer-sprite-cats__sprite[data-cat="2"] {
  --sprite-url: url("/images/cats/cat 2 (64х64).png");
}

.footer-sprite-cats__sprite[data-cat="3"] {
  --sprite-url: url("/images/cats/cat 3 (64х64).png");
}

/* Direction -> column mapping for 4-direction single-frame rows */
.footer-sprite-cats__sprite[data-dir="down"] {
  --dir-col: 0;
}

.footer-sprite-cats__sprite[data-dir="up"] {
  --dir-col: 1;
}

.footer-sprite-cats__sprite[data-dir="right"] {
  --dir-col: 2;
}

.footer-sprite-cats__sprite[data-dir="left"] {
  --dir-col: 3;
}

/* Row mapping (1-based in your sheet description; converted to 0-based here)
   Row 1: sit (4 dirs)
   Row 2: stand (4 dirs)
   Row 3: walk down
   Row 4: walk up
   Row 5: walk right
   Row 6: walk left
   Row 7-8: sleeping/rolling
   Row 9-12: run down/up/right/left
*/
.footer-sprite-cats__sprite[data-action="sit"] {
  --row: 0;
  background-position-x: calc(var(--dir-col) * var(--frame) * var(--scale) * -1);
}

.footer-sprite-cats__sprite[data-action="stand"] {
  --row: 1;
  background-position-x: calc(var(--dir-col) * var(--frame) * var(--scale) * -1);
}

.footer-sprite-cats__sprite[data-action="walk"][data-dir="down"] {
  --row: 2;
}

.footer-sprite-cats__sprite[data-action="walk"][data-dir="up"] {
  --row: 3;
}

.footer-sprite-cats__sprite[data-action="walk"][data-dir="right"] {
  --row: 4;
}

.footer-sprite-cats__sprite[data-action="walk"][data-dir="left"] {
  --row: 5;
}

.footer-sprite-cats__sprite[data-action="sleep"] {
  --row: 6;
  --anim-frames: 8;
  --anim-ms: 1100ms;
}

.footer-sprite-cats__sprite[data-action="run"][data-dir="down"] {
  --row: 8;
  --anim-frames: 6;
  --anim-ms: 520ms;
}

.footer-sprite-cats__sprite[data-action="run"][data-dir="up"] {
  --row: 9;
  --anim-frames: 6;
  --anim-ms: 520ms;
}

.footer-sprite-cats__sprite[data-action="run"][data-dir="right"] {
  --row: 10;
  --anim-frames: 6;
  --anim-ms: 520ms;
}

.footer-sprite-cats__sprite[data-action="run"][data-dir="left"] {
  --row: 11;
  --anim-frames: 6;
  --anim-ms: 520ms;
}

@keyframes footer-sprite-cats-walk {
  from {
    background-position-x: 0px;
  }
  to {
    background-position-x: calc(
      (var(--anim-frames) - 1) * var(--frame) * var(--scale) * -1
    );
  }
}

/* Only animate rows that are meant to be animated */
.footer-sprite-cats__sprite[data-animated="true"] {
  animation: footer-sprite-cats-walk var(--anim-ms)
    steps(var(--anim-frames)) infinite;
}

@media (prefers-reduced-motion: reduce) {
  .footer-sprite-cats__cat,
  .footer-sprite-cats__sprite[data-animated="true"] {
    animation: none !important;
  }

  .footer-sprite-cats__sprite {
    background-position-x: 0px !important;
  }
}
  animation: footer-cat-frame-c 0.8s steps(1) infinite;
}

.footer-cat__frame--d {
  animation: footer-cat-frame-d 0.8s steps(1) infinite;
}

.footer-cat--l2r {
  animation: footer-cat-move-l2r 32s linear infinite;
}

.footer-cat--r2l {
  bottom: 12px;
  animation: footer-cat-move-r2l 32s linear infinite;
  animation-delay: -16s;
}

/* Keep the chaser cat's walk/loaf modes in-phase with its delayed path */
.footer-cat--r2l .footer-cat__mode--walk,
.footer-cat--r2l .footer-cat__mode--loaf {
  animation-duration: 32s;
  animation-delay: -16s;
}

/* Yarn ball that the orange cat "chases" */
.footer-yarn {
  position: absolute;
  bottom: 12px;
  left: 0;
  pointer-events: none;
  -webkit-user-select: none;
  user-select: none;
  filter: drop-shadow(0 8px 12px hsla(var(--glow-secondary), 0.12));
  will-change: transform;
}

.footer-yarn__body {
  animation: footer-yarn-bounce 1.4s ease-in-out infinite;
}

.footer-yarn__sprite {
  image-rendering: pixelated;
  width: 80px;
  height: 80px;
}

@keyframes footer-yarn-roll-r2l {
  0% {
    transform: translateX(125vw) rotate(0deg);
  }
  45% {
    transform: translateX(58vw) rotate(-420deg);
  }
  /* meet + pause */
  50% {
    transform: translateX(58vw) rotate(-480deg);
  }
  56% {
    transform: translateX(58vw) rotate(-540deg);
  }
  100% {
    transform: translateX(-25vw) rotate(-980deg);
  }
}

@keyframes footer-yarn-bounce {
  0%,
  100% {
    translate: 0 0;
  }
  50% {
    translate: 0 -3px;
  }
}

.footer-yarn--r2l {
  animation: footer-yarn-roll-r2l 32s linear infinite;
  animation-delay: -16s;
}

.footer-heart {
  position: absolute;
  left: 50%;
  bottom: 66px;
  translate: -50% 0;
  pointer-events: none;
  -webkit-user-select: none;
  user-select: none;
  opacity: 0;
  animation: footer-heart-pop 32s ease-in-out infinite;
}

.footer-heart__sprite {
  image-rendering: pixelated;
  width: 44px;
  height: 44px;
  filter: drop-shadow(0 10px 18px hsla(var(--glow-accent), 0.15));
}

/* Laser dot + sparkles */
.footer-laser {
  position: absolute;
  bottom: 18px;
  left: 0;
  pointer-events: none;
  -webkit-user-select: none;
  user-select: none;
  opacity: 0;
  animation: footer-laser-show 16s ease-in-out infinite;
}

.footer-laser__sprite {
  image-rendering: pixelated;
  width: 28px;
  height: 28px;
  filter: drop-shadow(0 10px 18px hsla(var(--glow-accent), 0.25));
}

@keyframes footer-laser-show {
  0%,
  18%,
  100% {
    opacity: 0;
    transform: translateX(60vw);
  }
  22% {
    opacity: 1;
    transform: translateX(70vw);
  }
  30% {
    opacity: 1;
    transform: translateX(40vw);
  }
  34% {
    opacity: 0;
    transform: translateX(30vw);
  }
}

.footer-sparkle {
  position: absolute;
  pointer-events: none;
  -webkit-user-select: none;
  user-select: none;
  opacity: 0;
}

.footer-sparkle__sprite {
  image-rendering: pixelated;
  width: 36px;
  height: 36px;
  filter: drop-shadow(0 10px 18px hsla(var(--glow-secondary), 0.12));
}

.footer-sparkle--meet {
  left: calc(50% + 26px);
  bottom: 66px;
  translate: -50% 0;
  animation: footer-sparkle-pop 32s ease-in-out infinite;
}

.footer-sparkle--pounce {
  right: 20vw;
  bottom: 76px;
  animation: footer-sparkle-pounce 16s ease-in-out infinite;
}

@keyframes footer-sparkle-pop {
  0%,
  46% {
    opacity: 0;
    transform: scale(0.8);
  }
  52% {
    opacity: 1;
    transform: scale(1);
  }
  60% {
    opacity: 0;
    transform: scale(1.1);
  }
  100% {
    opacity: 0;
  }
}

@keyframes footer-sparkle-pounce {
  0%,
  22%,
  100% {
    opacity: 0;
    transform: translateY(0) scale(0.7);
  }
  26% {
    opacity: 1;
    transform: translateY(-6px) scale(1);
  }
  32% {
    opacity: 0;
    transform: translateY(-10px) scale(1.1);
  }
}

@media (prefers-reduced-motion: reduce) {
  .footer-cat,
  .footer-cat__body,
  .footer-cat__sprite-sheet--walk,
  .footer-cat__frame--a,
  .footer-cat__frame--b,
  .footer-cat__frame--c,
  .footer-cat__frame--d,
  .footer-cat__mode--walk,
  .footer-cat__mode--loaf,
  .footer-cat__mode--sit,
  .footer-yarn,
  .footer-yarn__body,
  .footer-heart,
  .footer-laser,
  .footer-sparkle {
    animation: none !important;
  }

  /* Ensure the sprite sheet stays on its first frame when motion is reduced. */
  .footer-cat__sprite-sheet {
    background-position-x: 0px !important;
  }
  .footer-cat::after {
    display: none;
  }
  .footer-cat--chaser .footer-cat__body::before {
    display: none;
  }
}
