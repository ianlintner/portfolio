@tailwind base;
@tailwind components;
@tailwind utilities;
/* --- Footer sprite cats (simple 64x64 sprites) --- */

.footer-sprite-cats {
  position: relative;
  height: 96px;
  overflow: hidden;
  border-top: 1px solid hsla(var(--border), 0.4);
  background: hsla(var(--background), 0.3);
  pointer-events: none;
}

.footer-sprite-cats__ground {
  position: absolute;
  inset-inline: 0;
  bottom: 8px;
  height: 1px;
  background: linear-gradient(
    90deg,
    transparent,
    hsla(var(--border), 0.8),
    transparent
  );
  opacity: 0.6;
}

.footer-sprite-cats__cat {
  position: absolute;
  bottom: 10px;
  left: 0;
  will-change: transform;
}

@keyframes footer-sprite-cats-pan-l2r {
  from {
    transform: translateX(-10vw);
  }
  to {
    transform: translateX(110vw);
  }
}

@keyframes footer-sprite-cats-pan-r2l {
  from {
    transform: translateX(110vw);
  }
  to {
    transform: translateX(-10vw);
  }
}

.footer-sprite-cats__cat--l2r {
  animation: footer-sprite-cats-pan-l2r 14s linear infinite;
}

.footer-sprite-cats__cat--r2l {
  animation: footer-sprite-cats-pan-r2l 16s linear infinite;
  animation-delay: -8s;
}

.footer-sprite-cats__sprite {
  /* Sheet: 14 columns x 72 rows of 64x64 tiles */
  --frame: 64px;
  --scale: 1;
  --sheet-cols: 14;
  --sheet-rows: 72;

  /* Nudge to keep the cat centered within the wrapper */
  --x-offset: -8px;

  /* Default animation frame-count (many rows only use the first 6 frames). */
  --anim-frames: 6;
  --anim-ms: 900ms;

  /* Cached start positions for animations */
  --x-start: calc(var(--x-offset));

  /* Direction column for single-frame rows (sit/stand): down/up/right/left */
  --dir-col: 0;

  /* Row index (0-based) */
  --row: 0;

  display: block;
  width: calc(var(--frame) * var(--scale));
  height: calc(var(--frame) * var(--scale));
  background-image: var(--sprite-url);
  background-repeat: no-repeat;
  background-size: calc(var(--sheet-cols) * var(--frame) * var(--scale))
    calc(var(--sheet-rows) * var(--frame) * var(--scale));
  background-position-x: var(--x-start);
  background-position-y: calc(var(--row) * var(--frame) * var(--scale) * -1);
  image-rendering: pixelated;
}

/* Sprite URL mapping */
.footer-sprite-cats__sprite[data-cat="1"] {
  --sprite-url: url("/images/cats/cat 1 (64х64).png");
}

.footer-sprite-cats__sprite[data-cat="2"] {
  --sprite-url: url("/images/cats/cat 2 (64х64).png");
}

.footer-sprite-cats__sprite[data-cat="3"] {
  --sprite-url: url("/images/cats/cat 3 (64х64).png");
}

/* Direction -> column mapping for 4-direction single-frame rows */
.footer-sprite-cats__sprite[data-dir="down"] {
  --dir-col: 0;
}

.footer-sprite-cats__sprite[data-dir="up"] {
  --dir-col: 1;
}

.footer-sprite-cats__sprite[data-dir="right"] {
  --dir-col: 2;
}

.footer-sprite-cats__sprite[data-dir="left"] {
  --dir-col: 3;
}

/* Row mapping (1-based in your sheet description; converted to 0-based here)
   Row 1: sit (4 dirs)
   Row 2: stand (4 dirs)
   Row 3: walk down
   Row 4: walk up
   Row 5: walk right
   Row 6: walk left
   Row 7-8: sleeping/rolling
   Row 9-12: run down/up/right/left
*/
.footer-sprite-cats__sprite[data-action="sit"] {
  --row: 0;
  background-position-x: calc(
    var(--x-offset) + var(--dir-col) * var(--frame) * var(--scale) * -1
  );
}

.footer-sprite-cats__sprite[data-action="stand"] {
  --row: 1;
  background-position-x: calc(
    var(--x-offset) + var(--dir-col) * var(--frame) * var(--scale) * -1
  );
}

.footer-sprite-cats__sprite[data-action="walk"][data-dir="down"] {
  --row: 2;
}

.footer-sprite-cats__sprite[data-action="walk"][data-dir="up"] {
  --row: 3;
}

.footer-sprite-cats__sprite[data-action="walk"][data-dir="right"] {
  --row: 4;
}

.footer-sprite-cats__sprite[data-action="walk"][data-dir="left"] {
  --row: 5;
}

.footer-sprite-cats__sprite[data-action="sleep"] {
  --row: 6;
  --anim-frames: 8;
  --anim-ms: 1100ms;
}

.footer-sprite-cats__sprite[data-action="run"][data-dir="down"] {
  --row: 8;
  --anim-frames: 6;
  --anim-ms: 520ms;
}

.footer-sprite-cats__sprite[data-action="run"][data-dir="up"] {
  --row: 9;
  --anim-frames: 6;
  --anim-ms: 520ms;
}

.footer-sprite-cats__sprite[data-action="run"][data-dir="right"] {
  --row: 10;
  --anim-frames: 6;
  --anim-ms: 520ms;
}

.footer-sprite-cats__sprite[data-action="run"][data-dir="left"] {
  --row: 11;
  --anim-frames: 6;
  --anim-ms: 520ms;
}

@keyframes footer-sprite-cats-walk {
  from {
    background-position-x: var(--x-start);
  }
  to {
    /* Move exactly N frames * width; steps(N) keeps jumps aligned to frame width. */
    background-position-x: calc(
      var(--x-start) + var(--anim-frames) * var(--frame) * var(--scale) * -1
    );
  }
}

/* Only animate rows that are meant to be animated */
.footer-sprite-cats__sprite[data-animated="true"] {
  animation: footer-sprite-cats-walk var(--anim-ms) steps(var(--anim-frames))
    infinite;
}

@media (prefers-reduced-motion: reduce) {
  .footer-sprite-cats__cat,
  .footer-sprite-cats__sprite[data-animated="true"] {
    animation: none !important;
  }

  .footer-sprite-cats__sprite {
    background-position-x: 0px !important;
  }
}
